new entry "Target_DivineBladeMove"
type "SpellData"
data "SpellType" "Target"
using "Target_MainHandAttack"
data "Level" "0"
data "SpellSchool" "Evocation"
data "ContainerSpells" "Target_DivineBladeMove_Normal;Target_DivineBladeMove_SneakAttack"
data "SpellProperties" "GROUND:DealDamage(MainMeleeWeapon, MainMeleeWeaponDamageType);GROUND:ExecuteWeaponFunctors(MainHand)"
data "SpellRoll" "AttackCantripsRoll()"
data "SpellSuccess" "DealDamage(LevelMapValue(ArcaneBladeDmg),Radiant,Magical);ApplyStatus(DIVINE_BLADE_MOVE,100,1);DealDamage(MainMeleeWeapon, MainMeleeWeaponDamageType);ExecuteWeaponFunctors(MainHand);"
data "TargetConditions" "not Self() and not Dead() and Character()"
data "Icon" "Spell_New_HolyWeapon"
data "DisplayName" "hfada4e61g2cf8g9fd5g4f34gf78868c05a45;2"
data "Description" "h507f8336gce0fg490egc520gfb12ce686a20;4"
data "DescriptionParams" "DealDamage(LevelMapValue(ArcaneBladeDmg),Radiant);DealDamage(LevelMapValue(ArcaneBladeDmg),Radiant);"
data "ExtraDescription" "had5f3d0bgbe08ge805g36e6gabd8ebb041af;6"
data "ExtraDescriptionParams" "DealDamage(1d8,Radiant)"
data "TooltipDamageList" "DealDamage(MainMeleeWeapon, MainMeleeWeaponDamageType);DealDamage(LevelMapValue(ArcaneBladeDmg),Radiant);"
data "TooltipAttackSave" "MeleeWeaponAttack;"
data "TooltipStatusApply" "ApplyStatus(DIVINE_BLADE,100,1)"
data "PrepareSound" "Spell_Prepare_Sorcerer_DivineBlade"
data "PrepareLoopSound" "Spell_Loop_Sorcerer_DivineBlade_Start"
data "CastSound" "Spell_Cast_Damage_Radiant_RadiantousSmite_L1to3"
data "TargetSound" "Spell_Impact_Damage_Radiant_RadiantousSmite_L1to3"
data "DualWieldingUseCosts" ""
data "SpellAnimation" "79f8640c-612a-4b13-aac7-bdc1b90458c2,,;655f5d8e-39c7-45b4-8a36-fdd3358a448c,,;c07a9d83-9a39-464a-b281-15c67c528ffb,,;32c33123-7962-4d95-b497-532b1a897e85,,;7f20e242-be7c-4fd1-a2bd-5715b2adca03,,;7465f7f7-67ea-41f2-8dd4-3c97f1089a54,,;0b07883a-08b8-43b6-ac18-84dc9e84ff50,,;,,;,,"
data "DualWieldingSpellAnimation" "6f9e662c-b10c-4388-9e56-d74320efa0c0,,;d668f9d6-bd9d-435c-83b5-6d46ac54761f,,;8e60eacb-12be-4711-96e2-d6d906a1ce25,,;603a7bfb-d53e-41c2-98dd-e004fdf5a0e8,,;003e58fc-f11d-41b6-90d9-ea8bc943826b,,;b850a756-6bd6-4c4d-a3fc-6c524a49a818,,;0b07883a-08b8-43b6-ac18-84dc9e84ff50,,;,,;,,"
data "VerbalIntent" "Damage"
data "SpellFlags" "IsMelee;IsHarmful;IsSpell;HasSomaticComponent;IsLinkedSpellContainer"
data "HitAnimationType" "MagicalDamage_Electric"
data "PrepareEffect" "d893dc86-cb68-4001-887d-7392b91e27b1"
data "CastEffect" "94f40b37-3da0-411f-82d4-6faae47f46d0"
data "TargetEffect" "6bc06551-f270-4b39-80d5-299fa11b7a2a"
data "DamageType" "Radiant"

new entry "Target_DivineBladeMove_Normal"
type "SpellData"
data "SpellType" "Target"
using "Target_MainHandAttack"
data "Level" "0"
data "SpellSchool" "Evocation"
data "SpellContainerID" "Target_DivineBladeMove"
data "SpellProperties" "GROUND:DealDamage(MainMeleeWeapon, MainMeleeWeaponDamageType);GROUND:ExecuteWeaponFunctors(MainHand)"
data "SpellRoll" "AttackCantripsRoll()"
data "SpellSuccess" "DealDamage(LevelMapValue(ArcaneBladeDmg),Radiant,Magical);ApplyStatus(DIVINE_BLADE_MOVE,100,1);DealDamage(MainMeleeWeapon, MainMeleeWeaponDamageType);ExecuteWeaponFunctors(MainHand);"
data "TargetConditions" "not Self() and not Dead() and Character()"
data "Icon" "Spell_New_HolyWeapon"
data "DisplayName" "h89f7afeagf533g9ff7ga8bdg974f7baa98f3;2"
data "Description" "h5afb1a45gc8d9g8139g0493g2784ac2f9d91;1"
data "DescriptionParams" "DealDamage(LevelMapValue(ArcaneBladeDmg),Radiant);DealDamage(LevelMapValue(ArcaneBladeDmg_Mystra),Radiant);"
data "ExtraDescription" "h3fc201fdg63edgd575gd42egcb4a388b6863;3"
data "ExtraDescriptionParams" "DealDamage(1d8,Radiant)"
data "TooltipDamageList" "DealDamage(MainMeleeWeapon, MainMeleeWeaponDamageType);DealDamage(LevelMapValue(ArcaneBladeDmg),Radiant);"
data "TooltipAttackSave" "MeleeWeaponAttack;"
data "TooltipStatusApply" "ApplyStatus(DIVINE_BLADE,100,1)"
data "PrepareSound" "Spell_Prepare_Sorcerer_DivineBlade"
data "PrepareLoopSound" "Spell_Loop_Sorcerer_DivineBlade_Start"
data "CastSound" "Spell_Cast_Damage_Radiant_RadiantousSmite_L1to3"
data "TargetSound" "Spell_Impact_Damage_Radiant_RadiantousSmite_L1to3"
data "DualWieldingUseCosts" ""
data "SpellAnimation" "79f8640c-612a-4b13-aac7-bdc1b90458c2,,;655f5d8e-39c7-45b4-8a36-fdd3358a448c,,;c07a9d83-9a39-464a-b281-15c67c528ffb,,;32c33123-7962-4d95-b497-532b1a897e85,,;7f20e242-be7c-4fd1-a2bd-5715b2adca03,,;7465f7f7-67ea-41f2-8dd4-3c97f1089a54,,;0b07883a-08b8-43b6-ac18-84dc9e84ff50,,;,,;,,"
data "DualWieldingSpellAnimation" "6f9e662c-b10c-4388-9e56-d74320efa0c0,,;d668f9d6-bd9d-435c-83b5-6d46ac54761f,,;8e60eacb-12be-4711-96e2-d6d906a1ce25,,;603a7bfb-d53e-41c2-98dd-e004fdf5a0e8,,;003e58fc-f11d-41b6-90d9-ea8bc943826b,,;b850a756-6bd6-4c4d-a3fc-6c524a49a818,,;0b07883a-08b8-43b6-ac18-84dc9e84ff50,,;,,;,,"
data "VerbalIntent" "Damage"
data "SpellFlags" "IsMelee;IsHarmful;IsSpell;HasSomaticComponent"
data "HitAnimationType" "MagicalDamage_Electric"
data "PrepareEffect" "d893dc86-cb68-4001-887d-7392b91e27b1"
data "CastEffect" "94f40b37-3da0-411f-82d4-6faae47f46d0"
data "TargetEffect" "6bc06551-f270-4b39-80d5-299fa11b7a2a"
data "DamageType" "Radiant"

new entry "Target_DivineBladeMove_SneakAttack"
type "SpellData"
data "SpellType" "Target"
using "Target_DivineBladeMove_Normal"
data "Cooldown" "OncePerTurn"
data "RequirementConditions" "WieldingFinesseWeaponInSpecificHand(context.Source,false) and HasActionResource('SneakAttack_Charge',1,0,false,false,context.Source)"
data "SpellSuccess" "DealDamage(LevelMapValue(ArcaneBladeDmg),Radiant,Magical);ApplyStatus(DIVINE_BLADE_MOVE,100,1);DealDamage(MainMeleeWeapon + LevelMapValue(SneakAttack), MainMeleeWeaponDamageType);ExecuteWeaponFunctors(MainHand);"
data "TargetConditions" "Character() and not Self() and not Dead() and ((HasAdvantage(AttackType.MeleeWeaponAttack) or HasAllyWithinRange('SG_Incapacitated',1.5) or (not HasEnemyWithinRange('SG_Incapacitated',1.5, nil, 2,context.Source,context.Target) and not HasAllyWithinRange('SG_Incapacitated',1.5, nil,false,context.Source,context.Target))) and not HasDisadvantage(AttackType.MeleeWeaponAttack)) and not Tagged('INANIMATE')"
data "DisplayName" "h4c58440eg7054g3b10gd36fg054016e2e29b;2"
data "ExtraDescription" "h5368dce2g230eg9c14g05f3g2d9af4bb5a9d;6"
data "TooltipDamageList" "DealDamage(MainMeleeWeapon + LevelMapValue(SneakAttack), MainMeleeWeaponDamageType);DealDamage(LevelMapValue(ArcaneBladeDmg),Radiant);"
data "UseCosts" "ActionPoint:1;SneakAttack_Charge:1"

new entry "Target_DivineBladeMove_Unlock"
type "SpellData"
data "SpellType" "Target"
using "Target_DivineBladeMove"
data "SpellContainerID" "Target_DivineBladeMove"
data "ContainerSpells" ";"
data "DisplayName" "hd04a8346ga84egfb7cg6d4fga10fa03bcf48;2"
data "DualWieldingUseCosts" "BonusActionPoint:1"
data "SpellFlags" "IsMelee;IsHarmful;IsSpell;HasSomaticComponent;IgnoreSilence"
data "InterruptPrototype" "Interrupt_DivineBladeMove"

new entry "Target_DivineBladeMove_Critical_Unlock"
type "SpellData"
data "SpellType" "Target"
using "Target_DivineBladeMove_Unlock"
data "DisplayName" "h3a6e59a9g968fge02bgc62bg635d3112d638;2"
data "InterruptPrototype" "Interrupt_DivineBladeMove_Critical"

new entry "DIVINE_BLADE_MOVE"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h868b9145g7f0dg5283g6d67g207448f19e30;2"
data "Description" "h7c8cac60g051bg55d9gb916g3caa4a7beca7;2"
data "Icon" "Spell_New_HolyWeapon"
data "HitAnimationType" "MagicalDamage_External"
data "SoundStart" "MAG_Status_Boost_Radiant_Reverberation"
data "StackId" "DIVINE_BLADE_MOVE"
data "StackType" "Stack"
data "TickType" "StartTurn"
data "RemoveEvents" "OnMove"
data "StatusPropertyFlags" "TickingWithSource"
data "OnRemoveFunctors" "IF(RemoveCause(StatusRemoveCause.Condition)):ApplyStatus(DIVINE_BLADE_ACTIVATE,100,1);IF(RemoveCause(StatusRemoveCause.Condition)):DealDamage(LevelMapValue(ArcaneBladeDmg_Mystra), Radiant,Magical)"
data "StatusEffect" "e148abeb-ae3b-4919-b565-1c2ca5e4c8bd"
data "ManagedStatusEffectType" "Negative"
data "ManagedStatusEffectGroup" "6435c10a-c67d-4f79-8813-b84b0762f92b"

new entry "DIVINE_BLADE_ACTIVATE"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "h645decc9g86aag3716ge5e0gec70d22d606a;1"
data "Icon" "Spell_New_HolyWeapon"
data "HitAnimationType" "MagicalDamage_External"
data "SoundStart" "Spell_Impact_Damage_Radiant_RadiantousSmite_L1to3"
data "StackId" "DIVINE_BLADE_ACTIVATE"
data "TickType" "StartTurn"
data "StatusPropertyFlags" "TickingWithSource;OverheadOnTurn;DisableOverhead;DisableCombatlog;DisablePortraitIndicator"
data "ApplyEffect" "df702a35-27e4-4a78-bdf2-fd5f3a8484b3"
data "StatusEffect" "a15aaf6c-5fcd-4602-a7b5-343c98d49591"
data "TargetEffect" "288e0f80-7d7c-4f36-b748-17182318180e"
data "ManagedStatusEffectType" "Negative"
data "ManagedStatusEffectGroup" "6435c10a-c67d-4f79-8813-b84b0762f92b"
data "EndEffect" "c116ee13-d397-4921-8d7c-3ca8388f9d55"

new entry "DIVINE_BLADE_ONCE"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "he2ce3ff3g6f09gf934g18e4g98014d0fa122;1"
data "Description" "h3e81ef1ag5844g7ea3g0b5cgd369ee7246d5;2"
data "Icon" "Spell_New_HolyWeapon"
data "RemoveConditions" "not HasAnyExtraAttack() and not HasHigherPriorityExtraAttackQueued()"
data "RemoveEvents" "OnStatusRemoved;OnStatusApplied"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog"

new entry "Interrupt_DivineBladeMove"
type "InterruptData"
data "DisplayName" "he69a3b57gcfaeg0ca8g53e3g1230c0eb898d;1"
data "Description" "he0adff8cg2b75g78ebg953fga8048a863701;1"
data "DescriptionParams" "DealDamage(LevelMapValue(ArcaneBladeDmg),Radiant);DealDamage(LevelMapValue(ArcaneBladeDmg),Radiant);"
data "ExtraDescription" "h14bd550aga55bg0475g10d1gbbb567113dc2;2"
data "Icon" "Spell_New_HolyWeapon"
data "InterruptContext" "OnCastHit"
data "InterruptContextScope" "Self"
data "Container" "YesNoDecision"
data "Conditions" "not HasAnyExtraAttack(context.Observer) and HasAnyExtraAttackQueued(context.Observer) and not HasStatus('ATTACK_CANTRIP_ONCE', context.Observer) and not HasSpellCastBlocked(context.Observer) and IsAbleToReact(context.Observer) and not Item() and IsMeleeAttack() and Self(context.Source,context.Observer) and HasDamageEffectFlag(DamageFlags.Hit) and IsWeaponAttack() and not IsCritical() and not IsKillingBlow() and IsAttackType(AttackType.MeleeWeaponAttack) and not (SpellId('Target_DivineBladeMove') or  SpellId('Target_GreenFlameBlade')) and not AnyEntityIsItem()"
data "Properties" "ApplyStatus(OBSERVER_OBSERVER,ATTACK_CANTRIP_ONCE,100,1);ApplyStatus(DIVINE_BLADE,100,1);DealDamage(LevelMapValue(ArcaneBladeDmg),Radiant,Magical);ApplyStatus(BLINDED, 100, 3);ApplyStatus(INTERRUPT_DIVINE_BLADE_VFX,100,0);"
data "Stack" "AttackCantrip"
data "EnableCondition" "(not HasStatus('SG_Polymorph')  and not HasStatus('ATTACK_CANTRIP_ONCE', context.Observer)) or Tagged('MINDFLAYER') or HasStatus('SG_Disguise')"
data "EnableContext" "OnStatusApplied;OnStatusRemoved"

new entry "Interrupt_DivineBladeMove_Critical"
type "InterruptData"
using "Interrupt_DivineBladeMove"
data "DisplayName" "h5803586ag6f25g4093g36d3g0dd36ebd205e;1"
data "ExtraDescription" "h65e7702fgb752g5f5cg83feg48d19bcb4b11;2"
data "Conditions" "not HasAnyExtraAttack(context.Observer) and HasAnyExtraAttackQueued(context.Observer) and not HasStatus('ATTACK_CANTRIP_ONCE', context.Observer) and not HasSpellCastBlocked(context.Observer) and IsAbleToReact(context.Observer) and not Item() and IsMeleeAttack() and Self(context.Source,context.Observer) and HasDamageEffectFlag(DamageFlags.Hit) and IsWeaponAttack() and IsCritical() and not IsKillingBlow() and not (SpellId('Target_DivineBladeMove') or SpellId('Target_GreenFlameBlade')) and not AnyEntityIsItem()"
data "InterruptDefaultValue" "Enabled"

